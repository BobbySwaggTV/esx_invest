<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <link href="style.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
    <style>
      #depositUI, #withdrawUI, #general, #topbar, #waiting
      {display: none;}
    </style>
  </head>

  <body>
    <div class="container">
      <div id="result"></div>
      <div class="topbar" id="topbar">
        <div class="cont-p-1">
          <div class="parale-1 "></div>
        </div>
        <div class="cont-p-2">
          <div class="parale-2"></div>
        </div>
        <div class="cont-p-3">
          <div class="parale-3"></div>
        </div>
        <nav>
          <div class="logo-topbar"></div>
          <button class="btn-sign-out">Would you like to disconnect?<i class="fas fa-sign-out-alt"></i></button>
        </nav>
      </div>

<!-- General -->

    <div class="cont-content" id="general">
      <div class="flex">
        <div class="balance box-shadow">
          <!-- Here will be the list of jobs -->
          <!-- TODO get a list of jobs and import them here -->

          <!-- <h1>The total list of jobs is <span class="total"></span></h1> This is kinda useless. -->
          <div id="main">
            <div id="jobs">
              <div id="list">
                <!-- This is where the list of jobs will be -->
              </div>
              <div id="selected">
                <div id="exist">
                  <h1>This shouldn't happen...</h1>
                  <div id="rate">
                    <!--TODO work out how to implement rates... based on   -->
                  </div>
                  <div id="action">
                    <h2>Actions</h2>
                    <div class="group_invest">
                      <input id="amount" type="number" placeholder="$0"></input>
                      <button class="btn btn-violet" type="submit" id="deposit">
                        <i class="far fa-money-bill-alt"></i>
                        <p>Investing</p>
                      </button>
                    </div>
                    <div class="group_invest">
                      <input id="amountw" type="number" placeholder="$0"></input>
                      <button class="btn btn-blue" type="submit" id="withdraw">
                        <i class="far fa-credit-card"></i>
                        <p>Withdraw</p>
                      </button>
                    </div>
                    <!--TODO Setting everything right here! -->
                  </div>
                </div>
              </div>
            </div>
          </div>
          </table>
        </div>
        <div class="list-btn">
          <button class="btn btn-blue" id="deposit">
            <i class="far fa-money-bill-alt"></i>
            <span class="far fa-money-bill-alt icon"></span>
            <p>Deposit<br>
            <span>Invest your money into a company and make profit!</span></p>
          </button>
          <button class="btn btn-violet" id="withdraw">
            <i class="far fa-credit-card"></i>
            <span class="far fa-credit-card icon"></span>
            <p>Withdraw<br>
            <span>Get your invested money back!</span></p>
          </button>
        </div>
      </div>
      <div class="flex">
        <div class="pub box-shadow confiance">
          <p>
            <span>Stock Market</span><br>
            The general stock has been going UP!
          </p>
          <div class="circle-confiance"></div>
        </div>
        <div class="pub box-shadow social">
          <p>
            <span>What will be your next investment?</span><br>
            You have all the possibilities!
          </p>
          <div class="social"></div>
        </div>
      </div>
    </div>

  <!-- Deposit -->

    <div class="cont-content" id="depositUI">
      <div class="flex">
        <div class="btn btn-blue banniere">
          <p>Deposit your money<br>
          <span>To invest into companys</span></p>
        </div>
        <button class="btn btn-grey back">
          <i class="fas fa-bars"></i>
          <span class="fas fa-arrow-left icon"></span>
          <p>Return<br>
          <span>To the main menu</span></p>
        </button>
      </div>
      <form id="deposit_event">
        <div class="input-cont box-shadow">
          <label>How much do you want to deposit</label>
          <input id="amount_deposit" type="number" placeholder="$0">
        </div>
        <button class="btn btn-green" type="submit">
          <i class="fas fa-check"></i>
          <span class="fas fa-check icon"></span>
          <p>Validate<br>
          <span>Your Deposit</span></p>
        </button>
      </form>
    </div>

  <!-- Withdraw -->

    <div class="cont-content" id="withdrawUI">
      <div class="flex">
        <div class="btn btn-violet banniere">
          <p>Withdraw money<br>
          <span>from your investment</span></p>
        </div>
        <button class="btn btn-grey back">
          <i class="fas fa-bars"></i>
          <span class="fas fa-arrow-left icon"></span>
          <p>Return<br>
          <span>to the main menu</span></p>
        </button>
      </div>
      <form id="withdraw_event">
        <div class="input-cont box-shadow">
          <label>How much do you want to withdraw</label>
          <input id="amount_withdraw" type="number" placeholder="$0">
        </div>
        <button class="btn btn-green" type="submit">
          <i class="fas fa-check"></i>
          <span class="fas fa-check icon"></span>
          <p>Validate<br>
          <span>Your withdrawal</span></p>
        </button>
      </form>
    </div>

  <!-- Start screen -->

    <div class="cont-waiting" id="waiting">
      <div class="content-waiting">
        <div class="mainlogo"></div>
        <p><span>Investing</span><br>
        Please login with your <span>finger</span></p>
        <div id="fingerprint-content">
          <div class="fingerprint-default"></div>
          <div class="fingerprint-active"></div>
          <div class="fingerprint-bar"></div>
        </div>
      </div>
      <div class="bg-waiting">
        <div class="cont-p-4">
          <div class="parale-4"></div>
        </div>
        <div class="cont-p-5">
          <div class="parale-5"></div>
        </div>
        <div class="cont-p-6">
          <div class="parale-6"></div>
        </div>
        <div class="cont-p-7">
          <div class="parale-7"></div>
        </div>
      </div>
    </div>

  <!-- Scripts -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="nui://game/ui/jquery.js" type="text/javascript"></script>
  <script type="text/javascript">
    $(function() {
    window.addEventListener('message', function(event) {
      if (event.data.type === "openGeneral") {
        $('#waiting').show();
        $('body').addClass("active");
        $('#exist').css('display', 'none');
        $('input').val("");

        // Makes the list empty if there is anything in it
        $('#list').empty()

        // Set the results(joblist) inside of the div list.
        for(let i in event.data.result) {
          let job = event.data.result[i];
          $('#list').append('<div class="jobs" id="'+ job.name +'">' + job.name + '</div>')
        }


        // If a job is clicked:
        $('.jobs').click(function() {
          $('#list').hide();
          $('#selected').css('display', 'block')
          $("#select_job").blur()

          let id = $(this).attr('id').replace('player_', '');
          selected = parseInt(id);

          let jobname = $(this).attr('job.name').replace('job', '')
          $('#exist').find('h1').text(selected + ", " + $(this).text())
        })
      } else if (event.data.type === "balanceHUD") { // When waiting is past and its still active
        $('.username1').html(event.data.player);
        $('.curbalance').html(event.data.balance);
      } else if (event.data.type === "joblist") {
        $('.joblist').html(event.data.result)
        $('.total').html(event.data.total)
      } else if (event.data.type === "closeAll"){
                $('#waiting, #general, #select_job, #depositUI, #topbar').hide();
                $('body').removeClass("active");
      } else if (event.data.type === "result") {
        if (event.data.t == "success")
          $("#result").attr('class', 'alert-green');
        else
          $("#result").attr('class', 'alert-orange');
        $("#result").html(event.data.m).show().delay(5000).fadeOut();
      }
    });
  });
      $('.btn-sign-out').click(function(){
          $('#general, #waiting, #withdrawUI, #depositUI, #topbar').hide();
          $('body').removeClass("active");
          $.post('http://esx_invest/NUIFocusOff', JSON.stringify({}));
      })
      $('.back').click(function(){
          $('#depositUI, #withdrawUI').hide();
          $('#general').show();
      })
      // $('#select_job').click(() =>{
      //     $('#list').hide()
      //     $('#selected').css('display', 'block')
      //     $("#select_job").blur()
      // })
      // $('#withdraw').click(function(){
      //     $('#general').hide();
      // })
      $('#fingerprint-content').click(function(){
          $('.fingerprint-active, .fingerprint-bar').addClass("active")
          setTimeout(function(){
            $('#general').css('display', 'block')
            $('#topbar').css('display', 'flex')
            $('#waiting').css('display', 'none')
            $('.fingerprint-active, .fingerprint-bar').removeClass("active")
          }, 1400);
      })

  // Deposit event
  $("#deposit").submit(function(e) {
    e.preventDefault(); // Prevent form from submitting
    $.post('http://esx_invest/deposit_event', JSON.stringify({
        amount: $("#amount_deposit").val()
    }));
    $('#exist').hide();
    $('#general').show();
    $("#amount_deposit").val('');
  });

  // Withdraw event
  $("#withdraw").submit(function(e) {
    e.preventDefault(); // Prevent form from submitting
    $.post('http://esx_invest/withdraw_event', JSON.stringify({
        amountw: $("#amount_withdraw").val()
    }));
    $('#exist').hide(); // Hides jobs
    $('#general').show(); // Shows General
    $("#amount_withdraw").val(''); //sets value to 0
  });

  document.onkeyup = function(data){
        if (data.which == 27){
            $('#general, #waiting, #exist, #notexist, #topbar').hide();
            $('body').removeClass("active");
            $.post('http://esx_invest/NUIFocusOff', JSON.stringify({}));
        }
    }
  </script>
</html>
